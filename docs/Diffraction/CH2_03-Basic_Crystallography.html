
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Basic Crystallography &#8212; MSE672: Introduction to TEM Spring 2021 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<p><strong>Chapter 2:</strong><a class="reference internal" href="Ch2_00-Diffraction.html"><span class="doc">Diffraction</span></a></p>
<hr style="height:1px;border-top:4px solid #FF8200" /><div class="section" id="Basic-Crystallography">
<h1>Basic Crystallography<a class="headerlink" href="#Basic-Crystallography" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://raw.githubusercontent.com/gduscher/MSE672-Introduction-to-TEM//main/Diffraction/CH2_03-Basic_Crystallography.ipynb">Download</a></p>
<p><a class="reference external" href="https://colab.research.google.com/github/gduscher/MSE672-Introduction-to-TEM/blob/main/Diffraction/CH2_03-Basic_Crystallography.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p>part of</p>
<p><a class="reference external" href="_MSE672_Intro_TEM.ipynb">MSE672: Introduction to Transmission Electron Microscopy</a></p>
<p>by Gerd Duscher, Spring 2021</p>
<p>Microscopy Facilities Joint Institute of Advanced Materials Materials Science &amp; Engineering The University of Tennessee, Knoxville</p>
<p>Background and methods to analysis and quantification of data acquired with transmission electron microscopes.</p>
<div class="section" id="Load-relevant-python-packages">
<h2>Load relevant python packages<a class="headerlink" href="#Load-relevant-python-packages" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Check-Installed-Packages">
<h3>Check Installed Packages<a class="headerlink" href="#Check-Installed-Packages" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">pkg_resources</span> <span class="kn">import</span> <span class="n">get_distribution</span><span class="p">,</span> <span class="n">DistributionNotFound</span>

<span class="k">def</span> <span class="nf">test_package</span><span class="p">(</span><span class="n">package_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test if package exists and returns version or -1&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">version</span> <span class="o">=</span> <span class="n">get_distribution</span><span class="p">(</span><span class="n">package_name</span><span class="p">)</span><span class="o">.</span><span class="n">version</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">DistributionNotFound</span><span class="p">,</span> <span class="ne">ImportError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;-1&#39;</span>
    <span class="k">return</span> <span class="n">version</span>

<span class="c1"># Colab setup ------------------</span>
<span class="k">if</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
    <span class="o">!</span>pip install pyTEMlib -q
<span class="c1"># pyTEMlib setup ------------------</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">test_package</span><span class="p">(</span><span class="s1">&#39;pyTEMlib&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="s1">&#39;0.2021.1.9&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;installing pyTEMlib&#39;</span><span class="p">)</span>
        <span class="o">!{</span>sys.executable<span class="o">}</span> -m pip install  --upgrade pyTEMlib -q
<span class="c1"># ------------------------------</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Load-the-plotting-and-figure-packages">
<h3>Load the plotting and figure packages<a class="headerlink" href="#Load-the-plotting-and-figure-packages" title="Permalink to this headline">¶</a></h3>
<p>Import the python packages that we will use:</p>
<p>Beside the basic numerical (numpy) and plotting (pylab of matplotlib) libraries, * three dimensional plotting and some libraries from the book * kinematic scattering library.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
    <span class="o">%</span><span class="k">pylab</span> --no-import-all inline
<span class="k">else</span><span class="p">:</span>
    <span class="o">%</span><span class="k">pylab</span> --no-import-all notebook

<span class="c1"># 3D plotting package</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span> <span class="c1"># 3D plotting</span>


<span class="c1"># Import libraries from the book</span>
<span class="kn">import</span> <span class="nn">pyTEMlib</span>
<span class="kn">import</span> <span class="nn">pyTEMlib.KinsCat</span> <span class="k">as</span> <span class="nn">ks</span>         <span class="c1"># Kinematic sCattering Library</span>
                             <span class="c1"># with Atomic form factors from Kirklands book</span>
<span class="c1"># it is a good idea to show the version numbers at this point for archiving reasons.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pyTEM version: &#39;</span><span class="p">,</span><span class="n">pyTEMlib</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Define-Crystal">
<h2>Define Crystal<a class="headerlink" href="#Define-Crystal" title="Permalink to this headline">¶</a></h2>
<p>A crystal is well defined by its unit cell and the atom positions within, the so called base.</p>
<p>The unit cell fills the volume completely when translated in all three directions. Placing the unit cell in a global carthesian coordination system, we need the length of the sides and their angles for a complete description. This is depicted in the graph below. <img alt="unitcell_angles.jpg" src="data:image/jpeg;base64,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" /></p>
<p>Figure taken from the wikipedia page on lattice constants.</p>
<p>Mathematically it is more advantageous to describe the unit cell as matrix, the ### Structure Matrix</p>
<p>This matrix consists of rows of vectors that span the unit cell: <span class="math notranslate nohighlight">\(\begin{bmatrix}  a_1 &amp; a_2 &amp; a_3 \\  b_1 &amp; b_2 &amp; b_3 \\  c_1 &amp; c_2 &amp; c_3 \\ \end{bmatrix} =\left[\vec{a},\vec{b},\vec{c}\right]\)</span>.</p>
<p>This structure matrix is also used to describe the super cells in materials simulations for example density functional theory.</p>
<p>The representation of unit cells as structure matrices allows also for easy conversions as we will see in the following.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Initialize the dictionary for all the input</span>
<span class="n">tags</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Create graphite unit cell (or structure matrix)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.246</span> <span class="c1">#nm</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">0.671</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">=</span> <span class="mi">90</span>

<span class="c1">## Create the structure matrix for a hexagonal system explicitly:</span>
<span class="n">tags</span><span class="p">[</span><span class="s1">&#39;unit_cell&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>  <span class="c1">## also called the structure matrix</span>
                    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">gamma</span><span class="p">))</span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">gamma</span><span class="p">))</span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="mf">0.</span> <span class="p">],</span>
                     <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
                    <span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;structure matrix </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;unit_cell&#39;</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>

<span class="n">tags</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span>
<span class="n">tags</span><span class="p">[</span><span class="s1">&#39;base&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;elements </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,(</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;base </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;base&#39;</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>


</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#alternatively with the function &quot;structure_by_name&quot; of the KinsCat library</span>

<span class="n">tags</span> <span class="o">=</span> <span class="n">ks</span><span class="o">.</span><span class="n">structure_by_name</span><span class="p">(</span><span class="s1">&#39;Graphite&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;structure matrix [nm]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;unit_cell&#39;</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;elements </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;base </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;base&#39;</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="Volume-of-Unit-Cell">
<h3>Volume of Unit Cell<a class="headerlink" href="#Volume-of-Unit-Cell" title="Permalink to this headline">¶</a></h3>
<p>We will need the volume of the unit cell for unit conversions later.</p>
<p>Volume of the parallelepiped (<a class="reference external" href="https://en.wikipedia.org/wiki/Triple_product">https://en.wikipedia.org/wiki/Triple_product</a>) : <span class="math notranslate nohighlight">\(\vec{a} \cdot \vec{b} \times \vec{c} = \det \begin{bmatrix}  a_1 &amp; a_2 &amp; a_3 \\  b_1 &amp; b_2 &amp; b_3 \\  c_1 &amp; c_2 &amp; c_3 \\ \end{bmatrix} ={\rm det}\left(\vec{a},\vec{b},\vec{c}\right)\)</span></p>
<p>We see that the structure matrix comes in handy for that calculation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;unit_cell&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;volume of unit cell: </span><span class="si">{</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> nm</span><span class="se">\u00b3</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Vector-Algebra-in-Unit-Cell">
<h3>Vector Algebra in Unit Cell<a class="headerlink" href="#Vector-Algebra-in-Unit-Cell" title="Permalink to this headline">¶</a></h3>
<p>We will use the linear algebra package of numpy (np.linalg) for our vector calculations.</p>
<p>The length of a vector is called its norm.</p>
<p>And the angle between two vectors is calculated by the dot product: $:nbsphinx-math:<cite>vec{a}</cite> <span class="math">\cdot `:nbsphinx-math:</span>vec{b}` = <span class="math">\left</span>| <span class="math">\vec{a}</span> <span class="math">\right</span>| <span class="math">\left</span>| <span class="math">\vec{b}</span> <span class="math">\right</span>| <span class="math">\cos `(:nbsphinx-math:</span>theta`) $</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">length_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;unit_cell&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;length of second unit cell vector is </span><span class="si">{</span><span class="n">length_b</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> nm&#39;</span> <span class="p">)</span>

<span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;unit_cell&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">length_b</span><span class="p">,</span> <span class="n">tags</span><span class="p">[</span><span class="s1">&#39;unit_cell&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">length_b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;angle between a and b is </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="se">\u00ba</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Plot-the-unit-cell">
<h3>Plot the unit cell<a class="headerlink" href="#Plot-the-unit-cell" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="c1"># draw unit_cell</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">tags</span><span class="p">[</span><span class="s1">&#39;unit_cell&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">tags</span><span class="p">[</span><span class="s1">&#39;unit_cell&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">tags</span><span class="p">[</span><span class="s1">&#39;unit_cell&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>

<span class="n">corners</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="o">+</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="o">+</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">+</span><span class="n">b</span><span class="p">]</span>
<span class="n">trace</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">trace</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="n">corners</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">corners</span><span class="p">[</span><span class="n">e</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>


<span class="c1"># draw atoms</span>
<span class="n">baseA</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;base&#39;</span><span class="p">],</span> <span class="n">tags</span><span class="p">[</span><span class="s1">&#39;unit_cell&#39;</span><span class="p">])</span> <span class="p">)</span>  <span class="c1"># convert to a list of carthesian coordinates</span>

<span class="c1">#initialize lists and a dictionary</span>
<span class="n">base</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">elements</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">]</span>
<span class="n">coloring</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Add atoms that are &#39;on the other side&#39; of the unit cell</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">baseA</span><span class="p">):</span>
    <span class="n">base</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">tags</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
        <span class="n">coloring</span><span class="p">[</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">corner</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span><span class="n">corner</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-15</span><span class="p">:</span>
            <span class="n">base</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="o">+</span><span class="n">corner</span><span class="p">)</span>
            <span class="n">elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">coloring</span><span class="p">)</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">base</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">atom</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">atom</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">coloring</span><span class="p">[</span><span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>

<span class="c1">## Matplotlib does not longer support  ax.set_aspect(&#39;equal&#39;) for 3D !!!</span>
<span class="n">maximum_position</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1.05</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span><span class="n">maximum_position</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span><span class="n">maximum_position</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span><span class="n">maximum_position</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## alternatively we can use a function in KinsCat.</span>
<span class="n">tags</span><span class="p">[</span><span class="s1">&#39;max_bond_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.22</span>
<span class="n">ks</span><span class="o">.</span><span class="n">plot_unitcell</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="May-be-with-a-few-more-atoms">
<h3>May be with a few more atoms<a class="headerlink" href="#May-be-with-a-few-more-atoms" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">corners</span><span class="p">,</span><span class="n">balls</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">bonds</span> <span class="o">=</span> <span class="n">ks</span><span class="o">.</span><span class="n">ball_and_stick</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">max_bond_length</span> <span class="o">=</span> <span class="mf">0.22</span><span class="p">)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">maximum_position</span> <span class="o">=</span> <span class="n">balls</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1.05</span>
<span class="n">maximum_x</span> <span class="o">=</span> <span class="n">balls</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">maximum_y</span> <span class="o">=</span> <span class="n">balls</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">maximum_z</span> <span class="o">=</span> <span class="n">balls</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">balls</span> <span class="o">=</span> <span class="n">balls</span> <span class="o">-</span> <span class="p">[</span><span class="n">maximum_x</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">maximum_y</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">maximum_z</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>


<span class="c1"># draw unit_cell</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">corners</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span> <span class="n">x</span><span class="o">-</span><span class="n">maximum_x</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="o">-</span><span class="n">maximum_y</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">z</span><span class="o">-</span><span class="n">maximum_z</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

<span class="c1"># draw bonds</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">bonds</span><span class="p">:</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span> <span class="n">x</span><span class="o">-</span><span class="n">maximum_x</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="o">-</span><span class="n">maximum_y</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">z</span><span class="o">-</span><span class="n">maximum_z</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span><span class="c1">#, tube_radius=0.02)</span>


<span class="c1"># draw atoms</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">balls</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">atom</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">atom</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">atom</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
              <span class="n">color</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ks</span><span class="o">.</span><span class="n">jmol_colors</span> <span class="p">[</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">]]),</span>
              <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">maximum_position</span> <span class="o">=</span> <span class="n">balls</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1.05</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_proj_type</span><span class="p">(</span><span class="s1">&#39;ortho&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span> <span class="o">-</span><span class="n">maximum_position</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">maximum_position</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span> <span class="o">-</span><span class="n">maximum_position</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">maximum_position</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span> <span class="o">-</span><span class="n">maximum_position</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">maximum_position</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

</pre></div>
</div>
</div>
<p>Or with the KinsCat library</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;extend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ks</span><span class="o">.</span><span class="n">plot_unitcell</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Okay,-the-above-plot-is-not-very-beautiful.">
<h3>Okay, the above plot is not very beautiful.<a class="headerlink" href="#Okay,-the-above-plot-is-not-very-beautiful." title="Permalink to this headline">¶</a></h3>
<p>If you use the <strong>ase</strong> or <strong>mayavi</strong> package, you can make nicer plots.</p>
<p>Please see: <a class="reference external" href="Plot_UnitCell.ipynb">Plot Unit Cell with Other Packages</a></p>
</div>
</div>
<div class="section" id="Reciprocal-Lattice">
<h2>Reciprocal Lattice<a class="headerlink" href="#Reciprocal-Lattice" title="Permalink to this headline">¶</a></h2>
<p>The unit cell in reciprocal space</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">reciprocal_lattice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;unit_cell&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span> <span class="c1"># transposed of inverted unit_cell</span>
<span class="n">tags</span><span class="p">[</span><span class="s1">&#39;reciprocal_lattice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reciprocal_lattice</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;reciprocal lattice [1/nm]:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">reciprocal_lattice</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="Reciprocal-Lattice-Vectors">
<h3>Reciprocal Lattice Vectors<a class="headerlink" href="#Reciprocal-Lattice-Vectors" title="Permalink to this headline">¶</a></h3>
<p>From your crystallography book and lecture you are probably used to the following expression for the reciprocal lattice vectors (<span class="math notranslate nohighlight">\(\vec{a}^*, \vec{c}^*, \vec{c}^*\)</span>)</p>
<div class="line-block">
<div class="line">$ :nbsphinx-math:<a href="#id1"><span class="problematic" id="id2">`</span></a>begin{align}
  vec{a}^* &amp;=  frac{vec{b} times vec{c}}{vec{a} cdot left(vec{b} times vec{c}right)} \
  vec{b}^* &amp;=  frac{vec{c} times vec{a}}{vec{b} cdot left(vec{c} times vec{a}right)} \
  vec{c}^* &amp;=  frac{vec{a} times vec{b}}{vec{c} cdot left(vec{a} times vec{b}right)}
end{align}`$</div>
</div>
<p>Where we see that the denominators of the above vector equations are the volume of the unit cell.</p>
<p>In physics book, you will see an additional factor of 2<span class="math notranslate nohighlight">\(\pi\)</span>, which is generally omitted in materials science and microscopy.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Now let&#39;s test whether this is really equivalent to the matrix expression above.</span>

<span class="n">a_recip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a_recip</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">b_recip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">b_recip</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">c_recip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">c_recip</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Compare to:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">reciprocal_lattice</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Permalink to this headline">¶</a></h2>
<p>With these definitions we have everything to define a crystal and to analyse diffraction and imaging data of crystalline specimens.</p>
<p>Crystallography deals with the application of symmetry and group theory of symmetry to crystal structures. If you want to play around with symmetry and space groups, you can install the <a class="reference external" href="http://atztogo.github.io/spglib/python-spglib.html#python-spglib">spglib</a>. The spglib is especially helpfull for determination of reduced unit cells (the smallest possible ones, instead of the ones with the full symmetry).</p>
<p>A number of common crystal structures are defined in the KinsCat libary under the function ‘’structure_by_name’’. Try them out in this notebook.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># As ususal the help function will show you the usage of a function:</span>
<span class="n">help</span><span class="p">(</span><span class="n">ks</span><span class="o">.</span><span class="n">structure_by_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">ks</span><span class="o">.</span><span class="n">crystal_data_base</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p>Now use one name of above structures and redo this notebook</p>
</div>
<div class="section" id="Navigation">
<h2>Navigation<a class="headerlink" href="#Navigation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Back Chapter 1:</strong><a class="reference internal" href="CH2_02-Atomic_Form_Factor.html"><span class="doc">Atomic Form Factor</span></a></p></li>
<li><p><strong>Next:</strong><a class="reference external" href="CH2_04-Structure_Factors.ipynb">Structure Factors</a></p></li>
<li><p><strong>Chapter 2:</strong><a class="reference external" href="CH2_00-_Diffraction.ipynb">Diffraction</a></p></li>
<li><p><strong>List of Content:</strong><a class="reference external" href="https://gduscher.github.io/MSE672-Introduction-to-TEM/index.html">Front</a></p></li>
</ul>
</div>
<div class="section" id="Appendix:-Read-POSCAR">
<h2>Appendix: Read POSCAR<a class="headerlink" href="#Appendix:-Read-POSCAR" title="Permalink to this headline">¶</a></h2>
<p>Load and draw a crystal structure from a POSCAR file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#tags = ks.read_poscar()</span>

<span class="c1">#tags[&#39;max_bond_length&#39;] = 0.27</span>

<span class="c1">#tags[&#39;extend&#39;] = [1,1,1]</span>
<span class="c1">#tags[name ]</span>
<span class="c1">#ks.plot_unitcell(tags)</span>
</pre></div>
</div>
</div>
<div class="section" id="The-function">
<h3>The function<a class="headerlink" href="#The-function" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">ase.io</span> <span class="kn">import</span> <span class="n">read</span><span class="p">,</span> <span class="n">write</span>
<span class="kn">import</span> <span class="nn">pyTEMlib.file_tools</span> <span class="k">as</span> <span class="nn">ft</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">Read_POSCAR</span><span class="p">():</span> <span class="c1"># open file dialog to select poscar file</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">ft</span><span class="o">.</span><span class="n">openfile_dialog</span><span class="p">(</span><span class="s1">&#39;POSCAR (POSCAR*.txt);;All files (*)&#39;</span><span class="p">)</span>
    <span class="c1">#use ase package to read file</span>

    <span class="n">base</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
    <span class="n">base_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">base</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">crystal</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;vasp&#39;</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


    <span class="c1">## make dictionary and plot structure (not essential for further notebook)</span>
    <span class="n">tags</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">tags</span><span class="p">[</span><span class="s1">&#39;unit_cell&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crystal</span><span class="o">.</span><span class="n">cell</span><span class="o">*</span><span class="mf">1e-1</span>
    <span class="n">tags</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crystal</span><span class="o">.</span><span class="n">get_chemical_symbols</span><span class="p">()</span>
    <span class="n">tags</span><span class="p">[</span><span class="s1">&#39;base&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crystal</span><span class="o">.</span><span class="n">get_scaled_positions</span><span class="p">()</span>

    <span class="n">tags</span><span class="p">[</span><span class="s1">&#39;max_bond_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.23</span>
    <span class="n">tags</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_name</span>

    <span class="k">return</span> <span class="n">tags</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#tags = ks.Read_POSCAR()</span>
<span class="c1">#tags[&#39;extend&#39;] = [2,2,1]</span>
<span class="c1">#ks.plot_unitcell(tags)</span>
<span class="c1">#plt.title(tags[&#39;name&#39;])</span>


</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">MSE672: Introduction to TEM</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Course Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Diffraction</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Gerd Duscher.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/Diffraction/CH2_03-Basic_Crystallography.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>